CREATE VIEW [dbo].[vwGuestInfo]
AS
SELECT 
    GuestId,
    GuestArchieved,
    EventId,
    FirstName,
    LastName,
    Address,
    PrimaryContactNo,
    SecondaryContactNo,
    EmailAddress,
    ModeOfCommunication,
    NoOfMembers,
    CreatedOn,
    CreatedBy,
    Source,
    WaresponseTime,
    GateKeeper,
    MessageId,
    AdditionalText,
    ImgSentMsgId,
    TextSent,
    TextDelivered,
    TextRead,
    TextFailed,
    ImgFailed,
    ImgSent,
    ImgDelivered,
    ImgRead,
    Cypertext,
    WhatsappStatus,
    whatsappMessageId,
    whatsappMessageImgId,
    waMessageEventLocationForSendingToAll,
    whatsappWatiEventLocationId,
    EventLocationSent,
    EventLocationDelivered,
    EventLocationRead,
    EventLocationFailed,
    ConguratulationMsgSent,
    ConguratulationMsgDelivered,
    ConguratulationMsgRead,
    ConguratulationMsgFailed,
    ConguratulationMsgId,
    WatiConguratulationMsgId,
    ReminderMessageId,
    ReminderMessageWatiId,
    ReminderMessageSent,
    ReminderMessageDelivered,
    ReminderMessageRead,
    ReminderMessageFailed,
    Response,
    CAST(CASE WHEN EXISTS (
        SELECT 1 FROM ScanHistory sh WHERE sh.GuestId = Guest.GuestId
    ) THEN 1 ELSE 0 END AS int) AS Scanned,
    IsPhoneNumberValid
FROM [dbo].[Guest]
GO
